### Программа формирования рабочей таблицы для секретарей приёмной комиссии МКН СПбГУ

В СПбГУ есть своя система в 1С для проверки и переноса заявлений с ЕПГУ сервиса "Поступление в ВУЗ онлайн" в внутреннюю базу Университета. Но в ней довольно много ошибок: часто абитуриенты теряются, неудобно проверять, обработан абитуриент или нет, нет возможности как бы то ни было работать со списком абитуриентов (например, хотим обзвонить всех олимпиадников -> невыполнимо! Хотим составить список ранжированный для обзвона и сверки с официальным -> невыполнимо! Проверить поступивших...), нельзя написать какое-либо примечание по работе с абитуриентом, а также работает вся эта система чрезвычайно медленно и т.д. и т.п. Узкий функционал и медленная скорость работы, но всё это нужно для формирования списков поступающих и для передачи информации по абитуриентам в другие части СПбГУ.

Для этого обычно секретари создавали таблицу, в которой для каждого абитуриента вручную вносили информацию, часто - копированием, например, такие столбцы:
ФИО, адрес, телефон, почта, программа, её приоритет, первые три приоритета абитуриента, результаты сдачи экзаменов, сумма баллов, количество баллов за индивидуальные достижения, если есть, то за что, есть ли право БВИ, тип конкурса, примечание и ещё несколько столбцов. В общем, крайне монотонное копирование каждого столбца по отдельности.

Осознав масштаб бедствия, я решил улучшить ситуацию и максимально автоматизировать процесс, для чего и предложил создать данную программу. Теперь секретарям нужно лишь проверить олимпиады и проставить баллы за ИД абитуриента, после чего провести абитуриента в системе 1С Университета. Копировать больше ничего не нужно, что ранее составляло большую часть времени работы. Также теперь все потеряшки легко обнаруживаются.

### Описание работы программы

На вход программе даётся: три таблицы-выгрузки формата CSV с Госуслуг (список поступающих, список документов и результаты экзаменов) и текущая версия рабочей таблицы.
По выгрузкам программа составляет новую рабочую таблицу с новыми данными (новые заявления, изменения старых). Многие столбцы необходимо просчитывать либо форматировать: брать лучший подтверждённый результат экзамена за определённые годы, если аттестат с отличием и проверенный - то поставить баллы за ИД, если есть олимпиады - поставить соответствующую отметку, вычислять первые 3 приоритета абитуриента... Ещё, например, отдельно просчитывается последнее состояние заявления, поскольку абитуриент может его изменять.

Затем программа склеивает полученную таблицу с рабочей таблицей, куда секретари вносили свои данные. Если заявление абитуриентом не менялось, то строчка останется неизменной (но результаты экзаменов, например, будут уже новые, если подгрузились), а если же заявление было изменено, то старыми останутся несколько столбцов (примечание, например). Для баллов ИД обеспечиваю, что они не ухудшаются (т.к. здесь секретарь проверил).

После этого таблица сортируется: наверх идут абитуриенты с необработанными или изменёнными заявлениями (проверенные идут вниз), а также абитуриенты с первым приоритетом на наш факультет будут выше. Ах да, здесь применяется блочная сортировка: все строчки с разными программами и конкурсами одного абитуриента будут идти строго вместе. Далее эта таблица выгружается в файл res.csv.

Для описанных задач применяется pandas (обработка входящих файлов и конвертирование одной xlsx таблицы), psycopg2 для работы с PostgreSQL (почти вся логика использует БД для работы). И консольный интерфейс чутка обёрнут в разные цвета)

Использование БД позволяет более гибко использовать данные: так, например, ценой небольших изменений и пары запросов сформировал другую таблицу с более подробной информацией про поступивших к нам абитуриентов.

В процессе разработки интерфейс таблицы часто менялся: просили добавить новые столбцы, изменить поведение при вычислении старых. Здесь вновь проявилась гибкость системы: старые данные было очень легко заменить на новые с помощью запросов к БД. Также в процессе разработки исправлялись ошибки, ускорялась работа программы и добавлялось красивостей)

В 2026 году, вероятно, Госуслуги вновь немного изменят формат своих выгрузок, из-за чего придётся скорректировать программу, но это не должно стать проблемой.
